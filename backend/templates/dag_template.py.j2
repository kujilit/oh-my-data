from airflow import DAG
from airflow.decorators import task
from datetime import datetime

default_args = {"start_date": datetime(2025, 1, 1)}

with DAG("{{ dag_name }}", schedule_interval=None, default_args=default_args, catchup=False) as dag:
    {% for node in nodes %}
    @task
    def {{ node.id }}():
        {{ node.code }}
    {% endfor %}

    {% for edge in edges %}
    {{ edge.from }}() >> {{ edge.to }}()
    {% endfor %}
